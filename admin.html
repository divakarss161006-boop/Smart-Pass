<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SmartPass Admin Dashboard</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0;font-family:"Poppins",sans-serif;}
    body{display:flex;min-height:100vh;background:#0f172a;color:#e2e8f0;}

    /* Sidebar */
    .sidebar{width:230px;background:#1e293b;padding:20px 0;display:flex;flex-direction:column;justify-content:space-between;}
    .logo-area{text-align:center;margin-bottom:25px;}
    .logo-area img{width:70px;height:70px;border-radius:50%;margin-bottom:10px;}
    .logo-area h2{font-size:16px;color:#10b981;font-weight:600;}

    .sidebar ul{list-style:none;padding:0;}
    .sidebar ul li{margin-bottom:10px;}
    .sidebar ul li a{color:#e2e8f0;text-decoration:none;display:flex;align-items:center;padding:10px 20px;border-radius:8px;transition:.3s;cursor:pointer;}
    .sidebar ul li a:hover,.sidebar ul li a.active{background:#10b981;color:#fff;}
    .sidebar ul li a span{margin-right:10px;font-weight:bold;}

    .export-btn{background:#10b981;color:white;border:none;padding:10px;width:80%;border-radius:8px;margin:20px auto;display:block;cursor:pointer;transition:.3s;}
    .export-btn:hover{background:#059669;}
    .logged-as{text-align:center;font-size:13px;color:#94a3b8;margin-bottom:15px;}

    /* Main Area */
    main{flex:1;padding:30px;}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;}
    header h1{font-size:22px;font-weight:600;color:#10b981;}

    .page{display:none;}
    .page.active{display:block;}

    /* Cards */
    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;margin-top:15px;}
    .card{background:#1e293b;border-radius:10px;padding:20px;box-shadow:0 4px 10px rgba(0,0,0,0.3);}
    .card h3{color:#10b981;font-size:18px;margin-bottom:10px;}
    .card p{font-size:14px;color:#cbd5e1;}

    /* Tables */
    table{width:100%;border-collapse:collapse;margin-top:15px;background:#1e293b;border-radius:10px;overflow:hidden;}
    th,td{text-align:left;padding:10px;border-bottom:1px solid #334155;font-size:14px;}
    th{color:#10b981;}
    tr:hover{background:#27364f;}

    .btn{padding:6px 10px;border-radius:6px;font-size:13px;cursor:pointer;border:none;}
    .approve-btn{background:#10b981;color:#fff;}
    .reject-btn{background:#ef4444;color:#fff;}

    @media (max-width:768px){
      body{flex-direction:column;}
      .sidebar{flex-direction:row;width:100%;overflow-x:auto;}
      .sidebar ul{display:flex;justify-content:space-around;}
      main{padding:20px;}
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div>
      <div class="logo-area">
        <img src="logo.png" alt="College Logo">
        <h2>SmartPass Admin</h2>
      </div>
      <ul>
        <li><a class="nav-btn active" data-section="dashboard"><span>D</span>Dashboard</a></li>
        <li><a class="nav-btn" data-section="students"><span>S</span> Students</a></li>
        <li><a class="nav-btn" data-section="staff"><span>T</span> Staff</a></li>
        <li><a class="nav-btn" data-section="requests"><span>R</span> Requests</a></li>
      </ul>
    </div>

    <div>
      <button class="export-btn">Export Requests CSV</button>
      <p class="logged-as">Logged in as: <strong>Administrator</strong></p>
    </div>
  </aside>

  <!-- Main Content -->
  <main>
    <header>
      <h1 id="page-title">Dashboard</h1>
    </header>

    <!-- === Dashboard === -->
    <section id="dashboard" class="page active">
      <div class="cards">
        <div class="card"><h3>Total Students</h3><p id="totalStudents">0</p></div>
        <div class="card"><h3>Total Requests</h3><p id="totalRequests">0</p></div>
        <div class="card"><h3>Pending</h3><p id="pendingRequests">0</p></div>
        <div class="card"><h3>Approved</h3><p id="approvedRequests">0</p></div>
      </div>
    </section>

    <!-- === Students === -->
    <section id="students" class="page">
      <h2>Student Management</h2>
      <table>
        <tr><th>Name</th><th>Roll No</th><th>Department</th><th>Year</th></tr>
        
      </table>
    </section>

    <!-- === Staff === -->
    <section id="staff" class="page">
      <h2>Staff Management</h2>
      <table>
        <tr><th>Name</th><th>Role</th><th>Email</th></tr>
      
      </table>
    </section>

    <!-- === Requests === -->
    <section id="requests" class="page">
      <h2>Leave / Outpass Requests</h2>
      <table id="requestsTable">
        <thead>
          <tr>
            <th>Student</th><th>Type</th><th>Reason</th><th>Out-Time</th><th>In-Time</th><th>Status</th><th>Action</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>
  </main>

  <script>
    const navButtons = document.querySelectorAll(".nav-btn");
    const pages = document.querySelectorAll(".page");
    const title = document.getElementById("page-title");

    navButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        navButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        const section = btn.getAttribute("data-section");
        pages.forEach(p => p.classList.remove("active"));
        document.getElementById(section).classList.add("active");
        title.textContent = btn.textContent.trim();
        if (section === "requests" || section === "dashboard") loadRequests();
      });
    });

    // === Load requests from localStorage ===
    function loadRequests() {
      const requests = JSON.parse(localStorage.getItem("sp_requests_v3")) || [];
      const tbody = document.querySelector("#requestsTable tbody");
      const total = document.getElementById("totalRequests");
      const pending = document.getElementById("pendingRequests");
      const approved = document.getElementById("approvedRequests");

      tbody.innerHTML = "";
      let p = 0, a = 0;
      if (requests.length === 0) {
        tbody.innerHTML = `<tr><td colspan="7" style="text-align:center;color:#94a3b8;">No requests yet</td></tr>`;
      }

      requests.forEach((r, i) => {
        if (r.status === "Pending") p++;
        if (r.status === "Approved") a++;
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${r.name}</td>
          <td>${r.leaveType}</td>
          <td>${r.reason}</td>
          <td>${r.from}</td>
          <td>${r.to}</td>
          <td style="color:${r.status==="Approved"?"#10b981":r.status==="Rejected"?"#ef4444":"#facc15"}">${r.status}</td>
          <td>${r.status==="Pending"?`
            <button class="btn approve-btn" onclick="updateStatus(${i}, 'Approved')">Approve</button>
            <button class="btn reject-btn" onclick="updateStatus(${i}, 'Rejected')">Reject</button>`:"-"}</td>
        `;
        tbody.appendChild(tr);
      });
      total.textContent = requests.length;
      pending.textContent = p;
      approved.textContent = a;
    }

    function updateStatus(index,status){
      const requests=JSON.parse(localStorage.getItem("sp_requests_v3"))||[];
      requests[index].status=status;
      localStorage.setItem("sp_requests_v3",JSON.stringify(requests));
      loadRequests();
    }

    // === Export CSV ===
    document.querySelector(".export-btn").addEventListener("click",()=>{
      const requests=JSON.parse(localStorage.getItem("sp_requests_v3"))||[];
      if(requests.length===0){alert("No requests to export!");return;}
      const csvHeader=["Student Name,Type,Reason,Out-Time,In-Time,Status"];
      const csvRows=requests.map(r=>`${r.name},${r.leaveType},${r.reason},${r.from},${r.to},${r.status}`);
      const csvContent=[csvHeader,...csvRows].join("\n");
      const blob=new Blob([csvContent],{type:"text/csv"});
      const url=URL.createObjectURL(blob);
      const a=document.createElement("a");
      a.href=url;a.download="requests.csv";a.click();
      URL.revokeObjectURL(url);
    });

    // Initial load
    loadRequests();
  </script>
</body>
</html>
